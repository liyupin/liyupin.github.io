

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Cper Liu">
  <meta name="keywords" content="">
  
    <meta name="description" content="命令行工具 (kubectl)Kubernetes 提供 kubectl 是使用 Kubernetes API 与 Kubernetes 集群的控制面进行通信的命令行工具。 这个工具叫做 kubectl。 针对配置信息，kubectl 在 $HOME&#x2F;.kube 目录中查找一个名为 config 的配置文件。 你可以通过设置 KUBECONFIG 环境变量或设置 –kubeconfig">
<meta property="og:type" content="article">
<meta property="og:title" content="命令行工具 (kubectl)">
<meta property="og:url" content="https://liyupin.github.io/2022/07/14/kubectl/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="命令行工具 (kubectl)Kubernetes 提供 kubectl 是使用 Kubernetes API 与 Kubernetes 集群的控制面进行通信的命令行工具。 这个工具叫做 kubectl。 针对配置信息，kubectl 在 $HOME&#x2F;.kube 目录中查找一个名为 config 的配置文件。 你可以通过设置 KUBECONFIG 环境变量或设置 –kubeconfig">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-07-14T02:47:00.000Z">
<meta property="article:modified_time" content="2022-07-14T05:45:54.805Z">
<meta property="article:author" content="Cper Liu">
<meta property="article:tag" content="k8s">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>命令行工具 (kubectl) - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"liyupin.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="命令行工具 (kubectl)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-07-14 10:47" pubdate>
          2022年7月14日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          14k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          118 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">命令行工具 (kubectl)</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="命令行工具-kubectl"><a href="#命令行工具-kubectl" class="headerlink" title="命令行工具 (kubectl)"></a>命令行工具 (kubectl)</h1><p>Kubernetes 提供 kubectl 是使用 Kubernetes API 与 Kubernetes 集群的控制面进行通信的命令行工具。</p>
<p>这个工具叫做 kubectl。</p>
<p>针对配置信息，kubectl 在 $HOME&#x2F;.kube 目录中查找一个名为 config 的配置文件。 你可以通过设置 KUBECONFIG 环境变量或设置 –kubeconfig</p>
<p>参数来指定其它 kubeconfig 文件。</p>
<p>本文概述了 kubectl 语法和命令操作描述，并提供了常见的示例。 有关每个命令的详细信息，包括所有受支持的参数和子命令， 请参阅 kubectl 参考文档。</p>
<p>有关安装说明，请参见安装 kubectl； 如需快速指南，请参见备忘单。 如果你更习惯使用 docker 命令行工具， Docker 用户的 kubectl 介绍了一些 Kubernetes 的等价命令。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>使用以下语法从终端窗口运行 kubectl 命令：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">kubectl <span class="hljs-selector-attr">[command]</span> <span class="hljs-selector-attr">[TYPE]</span> <span class="hljs-selector-attr">[NAME]</span> <span class="hljs-selector-attr">[flags]</span><br></code></pre></td></tr></table></figure>
<p>其中 command、TYPE、NAME 和 flags 分别是：</p>
<p>command：指定要对一个或多个资源执行的操作，例如 create、get、describe、delete。</p>
<p>TYPE：指定资源类型。资源类型不区分大小写， 可以指定单数、复数或缩写形式。例如，以下命令输出相同的结果：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl <span class="hljs-built_in">get</span> pod pod1<br>kubectl <span class="hljs-built_in">get</span> pods pod1<br>kubectl <span class="hljs-built_in">get</span> po pod1<br></code></pre></td></tr></table></figure>
<p>NAME：指定资源的名称。名称区分大小写。 如果省略名称，则显示所有资源的详细信息。例如：kubectl get pods。</p>
<p>在对多个资源执行操作时，你可以按类型和名称指定每个资源，或指定一个或多个文件：</p>
<p>要按类型和名称指定资源：</p>
<p>要对所有类型相同的资源进行分组，请执行以下操作：TYPE1 name1 name2 name&lt;#&gt;。<br>例子：kubectl get pod example-pod1 example-pod2</p>
<p>分别指定多个资源类型：TYPE1&#x2F;name1 TYPE1&#x2F;name2 TYPE2&#x2F;name3 TYPE&lt;#&gt;&#x2F;name&lt;#&gt;。<br>例子：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">kubectl <span class="hljs-built_in">get</span> pod/<span class="hljs-built_in">example</span>-pod1 replicationcontroller/<span class="hljs-built_in">example</span>-rc1<br></code></pre></td></tr></table></figure>
<p>用一个或多个文件指定资源：-f file1 -f file2 -f file&lt;#&gt;</p>
<p>使用 YAML 而不是 JSON， 因为 YAML 对用户更友好, 特别是对于配置文件。<br>例子：kubectl get -f .&#x2F;pod.yaml</p>
<p>flags： 指定可选的参数。例如，可以使用 -s 或 –server 参数指定 Kubernetes API 服务器的地址和端口。<br>注意： 从命令行指定的参数会覆盖默认值和任何相应的环境变量。<br>如果你需要帮助，在终端窗口中运行 kubectl help。</p>
<h2 id="集群内身份验证和命名空间覆盖"><a href="#集群内身份验证和命名空间覆盖" class="headerlink" title="集群内身份验证和命名空间覆盖"></a>集群内身份验证和命名空间覆盖</h2><p>默认情况下，kubectl 命令首先确定它是否在 Pod 中运行，从而被视为在集群中运行。 它首先检查 KUBERNETES_SERVICE_HOST 和 KUBERNETES_SERVICE_PORT 环境变量以及 &#x2F;var&#x2F;run&#x2F;secrets&#x2F;kubernetes.io&#x2F;serviceaccount&#x2F;token 中是否存在服务帐户令牌文件。 如果三个条件都被满足，则假定在集群内进行身份验证。</p>
<p>为保持向后兼容性，如果在集群内身份验证期间设置了 POD_NAMESPACE 环境变量，它将覆盖服务帐户令牌中的默认命名空间。 任何依赖默认命名空间的清单或工具都会受到影响。</p>
<p>POD_NAMESPACE 环境变量</p>
<p>如果设置了 POD_NAMESPACE 环境变量，对命名空间资源的 CLI 操作对象将使用该变量值作为默认值。 例如，如果该变量设置为 seattle，kubectl get pods 将返回 seattle 命名空间中的 Pod。 这是因为 Pod 是一个命名空间资源，且命令中没有提供命名空间。</p>
<p>直接使用 –namespace <value> 会覆盖此行为。</p>
<p>kubectl 如何处理 ServiceAccount 令牌</p>
<p>假设：</p>
<p>有 Kubernetes 服务帐户令牌文件挂载在 &#x2F;var&#x2F;run&#x2F;secrets&#x2F;kubernetes.io&#x2F;serviceaccount&#x2F;token 上，并且<br>设置了 KUBERNETES_SERVICE_HOST 环境变量，并且<br>设置了 KUBERNETES_SERVICE_PORT 环境变量，并且<br>你没有在 kubectl 命令行上明确指定命名空间。<br>然后 kubectl 假定它正在你的集群中运行。 kubectl 工具查找该 ServiceAccount 的命名空间 （该命名空间与 Pod 的命名空间相同）并针对该命名空间进行操作。 这与集群外运行的情况不同； 当 kubectl 在集群外运行并且你没有指定命名空间时， kubectl 命令会针对 default 命名空间进行操作。</p>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>下表包含所有 kubectl 操作的简短描述和普通语法：</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs coq">操作	语法	描述<br>alpha	kubectl alpha SUBCOMMAND [flags]	列出与 alpha 特性对应的可用命令，这些特性在 Kubernetes 集群中默认情况下是不启用的。<br>annotate	kubectl annotate (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]	添加或更新一个或多个资源的注解。<br>api-resources	kubectl api-resources [flags]	列出可用的 API 资源。<br>api-versions	kubectl api-versions [flags]	列出可用的 API 版本。<br><span class="hljs-built_in">apply</span> | <span class="hljs-type">kubectl</span> <span class="hljs-built_in">apply</span> -f FILENAME [flags]| <span class="hljs-type">从文件或 stdin</span> 对资源应用配置更改。 attach | <span class="hljs-type">kubectl</span> attach POD -c CONTAINER [-i] [-t] [flags] | <span class="hljs-type">挂接到正在运行的容器，查看输出流或与容器（stdin</span>）交互。 auth | <span class="hljs-type">kubectl</span> auth [flags] [options] | <span class="hljs-type">检查授权。 autoscale</span> | <span class="hljs-type">kubectl</span> autoscale (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) [--min=MINPODS] --max=MAXPODS [--cpu-percent=CPU] [flags] | <span class="hljs-type">自动扩缩由副本控制器管理的一组 pod</span>。 certificate | <span class="hljs-type">kubectl</span> certificate SUBCOMMAND [options] | <span class="hljs-type">修改证书资源。 cluster</span>-info | <span class="hljs-type">kubectl</span> cluster-info [flags] | <span class="hljs-type">显示有关集群中主服务器和服务的端口信息。 completion</span> | <span class="hljs-type">kubectl</span> completion SHELL [options] | <span class="hljs-type">为指定的 Shell</span>（Bash 或 Zsh）输出 Shell 补齐代码。 config | <span class="hljs-type">kubectl</span> config SUBCOMMAND [flags] | <span class="hljs-type">修改 kubeconfig</span> 文件。有关详细信息，请参阅各个子命令。<br><br>convert | <span class="hljs-type">kubectl</span> convert -f FILENAME [options] | <span class="hljs-type">在不同的 API</span> 版本之间转换配置文件。配置文件可以是 YAML 或 JSON 格式。注意 - 需要安装 kubectl-convert 插件。 cordon | <span class="hljs-type">kubectl</span> cordon NODE [options] | <span class="hljs-type">将节点标记为不可调度。 cp</span> | <span class="hljs-type">kubectl</span> cp &lt;file-spec-src&gt; &lt;file-spec-dest&gt; [options] | <span class="hljs-type">从容器复制文件、目录或将文件、目录复制到容器。 create</span> | <span class="hljs-type">kubectl</span> create -f FILENAME [flags] | <span class="hljs-type">从文件或 stdin</span> 创建一个或多个资源。 delete | <span class="hljs-type">kubectl</span> delete (-f FILENAME | <span class="hljs-type">TYPE</span> [NAME | <span class="hljs-type">/NAME</span> | <span class="hljs-type">-l</span> label | <span class="hljs-type">--all</span>]) [flags] | <span class="hljs-type">基于文件、标准输入或通过指定标签选择器、名称、资源选择器或资源本身，删除资源。 describe</span> | <span class="hljs-type">kubectl</span> describe (-f FILENAME | <span class="hljs-type">TYPE</span> [NAME_PREFIX | <span class="hljs-type">/NAME</span> | <span class="hljs-type">-l</span> label]) [flags] | <span class="hljs-type">显示一个或多个资源的详细状态。 diff</span> | <span class="hljs-type">kubectl</span> diff -f FILENAME [flags]| <span class="hljs-type">在当前起作用的配置和文件或标准输之间作对比 (BETA</span>)<br><br>drain | <span class="hljs-type">kubectl</span> drain NODE [options] | <span class="hljs-type">腾空节点以准备维护。 edit</span> | <span class="hljs-type">kubectl</span> edit (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) [flags] | <span class="hljs-type">使用默认编辑器编辑和更新服务器上一个或多个资源的定义。 exec</span> | <span class="hljs-type">kubectl</span> exec POD [-c CONTAINER] [-i] [-t] [flags] [-- COMMAND [args...]] | <span class="hljs-type">对 Pod</span> 中的容器执行命令。 explain | <span class="hljs-type">kubectl</span> explain [--recursive=false] [flags] | <span class="hljs-type">获取多种资源的文档。例如 Pod</span>、Node、Service 等。 expose | <span class="hljs-type">kubectl</span> expose (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) [--port=port] [--protocol=TCP|<span class="hljs-type">UDP</span>] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--type=type] [flags] | <span class="hljs-type">将副本控制器、服务或 Pod</span> 作为新的 Kubernetes 服务暴露。 get | <span class="hljs-type">kubectl</span> get (-f FILENAME | <span class="hljs-type">TYPE</span> [NAME | <span class="hljs-type">/NAME</span> | <span class="hljs-type">-l</span> label]) [--watch] [--sort-<span class="hljs-built_in">by</span>=FIELD] [[-o | <span class="hljs-type">--output</span>]=OUTPUT_FORMAT] [flags] | <span class="hljs-type">列出一个或多个资源。 kustomize</span> | <span class="hljs-type">kubectl</span> kustomize<br><br>[flags] [options]` | <span class="hljs-type">列出从 kustomization</span>.yaml 文件中的指令生成的一组 API 资源。参数必须是包含文件的目录的路径，或者是 git 存储库 URL，其路径后缀相对于存储库根目录指定了相同的路径。<br>label | <span class="hljs-type">kubectl</span> label (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags] | <span class="hljs-type">添加或更新一个或多个资源的标签。 logs</span> | <span class="hljs-type">kubectl</span> logs POD [-c CONTAINER] [--follow] [flags] | <span class="hljs-type">打印 Pod</span> 中容器的日志。 options | <span class="hljs-type">kubectl</span> options | <span class="hljs-type">全局命令行选项列表，这些选项适用于所有命令。 patch</span> | <span class="hljs-type">kubectl</span> patch (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) --patch PATCH [flags] | <span class="hljs-type">使用策略合并流程更新资源的一个或多个字段。 plugin</span> | <span class="hljs-type">kubectl</span> plugin [flags] [options] | <span class="hljs-type">提供用于与插件交互的实用程序。 port</span>-forward | <span class="hljs-type">kubectl</span> port-forward POD [LOCAL_PORT:]REMOTE_PORT [...[LOCAL_PORT_N:]REMOTE_PORT_N] [flags] | <span class="hljs-type">将一个或多个本地端口转发到一个 Pod</span>。 proxy | <span class="hljs-type">kubectl</span> proxy [--port=PORT] [--www=static-dir] [--www-prefix=prefix] [--api-prefix=prefix] [flags] | <span class="hljs-type">运行访问 Kubernetes</span> API 服务器的代理。 <span class="hljs-built_in">replace</span> | <span class="hljs-type">kubectl</span> <span class="hljs-built_in">replace</span> -f FILENAME | <span class="hljs-type">基于文件或标准输入替换资源。 rollout</span> | <span class="hljs-type">kubectl</span> rollout SUBCOMMAND [options] | <span class="hljs-type">管理资源的上线。有效的资源类型包括：Deployment</span>、 DaemonSet 和 StatefulSet。 run | <span class="hljs-type">kubectl</span> run NAME --image=image [--env=<span class="hljs-string">&quot;key=value&quot;</span>] [--port=port] [--dry-run=server | <span class="hljs-type">client</span> | <span class="hljs-type">none</span>] [--overrides=inline-json] [flags] | <span class="hljs-type">在集群上运行指定的镜像。</span><br><span class="hljs-type"></span><br><span class="hljs-type">scale</span> | <span class="hljs-type">kubectl</span> scale (-f FILENAME | <span class="hljs-type">TYPE</span> NAME | <span class="hljs-type">TYPE</span>/NAME) --replicas=COUNT [--resource-version=version] [--current-replicas=count] [flags] | <span class="hljs-type">更新指定副本控制器的大小。 set</span> | <span class="hljs-type">kubectl</span> <span class="hljs-built_in">set</span> SUBCOMMAND [options] | <span class="hljs-type">配置应用资源。 taint</span> | <span class="hljs-type">kubectl</span> taint NODE NAME KEY_1=VAL_1:TAINT_EFFECT_1 ... KEY_N=VAL_N:TAINT_EFFECT_N [options] | <span class="hljs-type">更新一个或多个节点上的污点。 top</span> | <span class="hljs-type">kubectl</span> <span class="hljs-built_in">top</span> [flags] [options] | <span class="hljs-type">显示资源（CPU</span>、内存、存储）的使用情况。 uncordon | <span class="hljs-type">kubectl</span> uncordon NODE [options] | <span class="hljs-type">将节点标记为可调度。 version</span> | <span class="hljs-type">kubectl</span> version [--client] [flags] | <span class="hljs-type">显示运行在客户端和服务器上的 Kubernetes</span> 版本。 wait | <span class="hljs-type">kubectl</span> wait ([-f FILENAME] | <span class="hljs-type">resource</span>.group/resource.name | <span class="hljs-type">resource</span>.group [(-l label | <span class="hljs-type">--all</span>)]) [--<span class="hljs-keyword">for</span>=delete|<span class="hljs-type">--for</span> condition=available] [options] | <span class="hljs-type">实验特性：等待一种或多种资源的特定状况。</span><br></code></pre></td></tr></table></figure>
<p>了解更多有关命令操作的信息， 请参阅 kubectl 参考文档。</p>
<h2 id="资源类型"><a href="#资源类型" class="headerlink" title="资源类型"></a>资源类型</h2><p>下表列出所有受支持的资源类型及其缩写别名。</p>
<p>(以下输出可以通过 kubectl api-resources 获取，内容以 Kubernetes 1.19.1 版本为准。)</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs stylus">资源名	缩写名	API 分组	按命名空间	资源类型<br>bindings			true	Binding<br>componentstatuses	cs		false	ComponentStatus<br>configmaps	cm		true	ConfigMap<br>endpoints	ep		true	Endpoints<br>events	ev		true	Event<br>limitranges	limits		true	LimitRange<br>namespaces	ns		false	Namespace<br>nodes	no		false	Node<br>persistentvolumeclaims	pvc		true	PersistentVolumeClaim<br>persistentvolumes	pv		false	PersistentVolume<br>pods	po		true	Pod<br>podtemplates			true	PodTemplate<br>replicationcontrollers	rc		true	ReplicationController<br>resourcequotas	quota		true	ResourceQuota<br>secrets			true	Secret<br>serviceaccounts	sa		true	ServiceAccount<br>services	svc		true	Service<br>mutatingwebhookconfigurations		admissionregistration<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	MutatingWebhookConfiguration<br>validatingwebhookconfigurations		admissionregistration<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	ValidatingWebhookConfiguration<br>customresourcedefinitions	crd,crds	apiextensions<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	CustomResourceDefinition<br>apiservices		apiregistration<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	APIService<br>controllerrevisions		apps	true	ControllerRevision<br>daemonsets	ds	apps	true	DaemonSet<br>deployments	deploy	apps	true	Deployment<br>replicasets	rs	apps	true	ReplicaSet<br>statefulsets	sts	apps	true	StatefulSet<br>tokenreviews		authentication<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	TokenReview<br>localsubjectaccessreviews		authorization<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	LocalSubjectAccessReview<br>selfsubjectaccessreviews		authorization<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	SelfSubjectAccessReview<br>selfsubjectrulesreviews		authorization<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	SelfSubjectRulesReview<br>subjectaccessreviews		authorization<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	SubjectAccessReview<br>horizontalpodautoscalers	hpa	autoscaling	true	HorizontalPodAutoscaler<br>cronjobs	cj	batch	true	CronJob<br>jobs		batch	true	Job<br>certificatesigningrequests	csr	certificates<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	CertificateSigningRequest<br>leases		coordination<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	Lease<br>endpointslices		discovery<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	EndpointSlice<br>events	ev	events<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	Event<br>ingresses	ing	extensions	true	Ingress<br>flowschemas		flowcontrol<span class="hljs-selector-class">.apiserver</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	FlowSchema<br>prioritylevelconfigurations		flowcontrol<span class="hljs-selector-class">.apiserver</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	PriorityLevelConfiguration<br>ingressclasses		networking<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	IngressClass<br>ingresses	ing	networking<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	Ingress<br>networkpolicies	netpol	networking<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	NetworkPolicy<br>runtimeclasses		node<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	RuntimeClass<br>poddisruptionbudgets	pdb	policy	true	PodDisruptionBudget<br>podsecuritypolicies	psp	policy	false	PodSecurityPolicy<br>clusterrolebindings		rbac<span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	ClusterRoleBinding<br>clusterroles		rbac<span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	ClusterRole<br>rolebindings		rbac<span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	RoleBinding<br>roles		rbac<span class="hljs-selector-class">.authorization</span><span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	true	Role<br>priorityclasses	pc	scheduling<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	PriorityClass<br>csidrivers		storage<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	CSIDriver<br>csinodes		storage<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	CSINode<br>storageclasses	sc	storage<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	StorageClass<br>volumeattachments		storage<span class="hljs-selector-class">.k8s</span><span class="hljs-selector-class">.io</span>	false	VolumeAttachment<br></code></pre></td></tr></table></figure>
<h2 id="输出选项"><a href="#输出选项" class="headerlink" title="输出选项"></a>输出选项</h2><p>有关如何格式化或排序某些命令的输出的信息，请参阅以下章节。有关哪些命令支持不同输出选项的详细信息， 请参阅 kubectl 参考文档。</p>
<h3 id="格式化输出"><a href="#格式化输出" class="headerlink" title="格式化输出"></a>格式化输出</h3><p>所有 kubectl 命令的默认输出格式都是人类可读的纯文本格式。要以特定格式在终端窗口输出详细信息， 可以将 -o 或 –output 参数添加到受支持的 kubectl 命令中。</p>
<p>语法<br>kubectl [command] [TYPE] [NAME] -o <output_format><br>取决于具体的 kubectl 操作，支持的输出格式如下：</p>
<p>输出格式	描述<br>-o custom-columns&#x3D;<spec>	使用逗号分隔的自定义列列表打印表。<br>-o custom-columns-file&#x3D;<filename>	使用 <filename> 文件中的自定义列模板打印表。<br>-o json	输出 JSON 格式的 API 对象<br>-o jsonpath&#x3D;<template>	打印 jsonpath 表达式定义的字段<br>-o jsonpath-file&#x3D;<filename>	打印 <filename> 文件中 jsonpath 表达式定义的字段。<br>-o name	仅打印资源名称而不打印任何其他内容。<br>-o wide	以纯文本格式输出，包含所有附加信息。对于 Pod 包含节点名。<br>-o yaml	输出 YAML 格式的 API 对象。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>在此示例中，以下命令将单个 Pod 的详细信息输出为 YAML 格式的对象：</p>
<p>kubectl get pod web-pod-13je7 -o yaml<br>请记住：有关每个命令支持哪种输出格式的详细信息， 请参阅 kubectl 参考文档。</p>
<p>自定义列<br>要定义自定义列并仅将所需的详细信息输出到表中，可以使用 custom-columns 选项。 你可以选择内联定义自定义列或使用模板文件：-o custom-columns&#x3D;<spec> 或 -o custom-columns-file&#x3D;<filename>。</p>
<p>示例<br>内联：</p>
<p>kubectl get pods <pod-name> -o custom-columns&#x3D;NAME:.metadata.name,RSRC:.metadata.resourceVersion<br>模板文件：</p>
<p>kubectl get pods <pod-name> -o custom-columns-file&#x3D;template.txt<br>其中，template.txt 文件包含：</p>
<p>NAME          RSRC<br>metadata.name metadata.resourceVersion<br>运行这两个命令之一的结果类似于：</p>
<p>NAME           RSRC<br>submit-queue   610995<br>Server-side 列<br>kubectl 支持从服务器接收关于对象的特定列信息。 这意味着对于任何给定的资源，服务器将返回与该资源相关的列和行，以便客户端打印。 通过让服务器封装打印的细节，这允许在针对同一集群使用的客户端之间提供一致的人类可读输出。</p>
<p>此功能默认启用。要禁用它，请将该 –server-print&#x3D;false 参数添加到 kubectl get 命令中。</p>
<p>例子：<br>要打印有关 Pod 状态的信息，请使用如下命令：</p>
<p>kubectl get pods <pod-name> –server-print&#x3D;false<br>输出类似于：</p>
<p>NAME       AGE<br>pod-name   1m</p>
<h3 id="排序列表对象"><a href="#排序列表对象" class="headerlink" title="排序列表对象"></a>排序列表对象</h3><p>要将对象排序后输出到终端窗口，可以将 –sort-by 参数添加到支持的 kubectl 命令。 通过使用 –sort-by 参数指定任何数字或字符串字段来对对象进行排序。 要指定字段，请使用 jsonpath 表达式。</p>
<p>语法<br>kubectl [command] [TYPE] [NAME] –sort-by&#x3D;<jsonpath_exp></p>
<p>示例</p>
<p>要打印按名称排序的 Pod 列表，请运行：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl <span class="hljs-built_in">get</span> pods <span class="hljs-attribute">--sort-by</span>=.metadata.name<br></code></pre></td></tr></table></figure>
<h2 id="示例：常用操作"><a href="#示例：常用操作" class="headerlink" title="示例：常用操作"></a>示例：常用操作</h2><p>使用以下示例集来帮助你熟悉运行常用 kubectl 操作：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">kubectl apply - 以文件或标准输入为准应用或更新资源。<br><br># 使用 example-service.yaml 中的定义创建服务。<br>kubectl apply -f example-service.yaml<br><br># 使用 example-controller.yaml 中的定义创建 <span class="hljs-keyword">replication</span> controller。<br>kubectl apply -f example-controller.yaml<br><br># 使用 &lt;directory&gt; 路径下的任意 .yaml、.yml 或 .json 文件 创建对象。<br>kubectl apply -f &lt;directory&gt;<br>kubectl <span class="hljs-keyword">get</span> - 列出一个或多个资源。<br><br># 以纯文本输出格式列出所有 Pod。<br>kubectl <span class="hljs-keyword">get</span> pods<br><br># 以纯文本输出格式列出所有 Pod，并包含附加信息(如节点名)。<br>kubectl <span class="hljs-keyword">get</span> pods -o wide<br><br># 以纯文本输出格式列出具有指定名称的副本控制器。提示：你可以使用别名 <span class="hljs-string">&#x27;rc&#x27;</span> 缩短和替换 <span class="hljs-string">&#x27;replicationcontroller&#x27;</span> 资源类型。<br>kubectl <span class="hljs-keyword">get</span> replicationcontroller &lt;rc-<span class="hljs-type">name</span>&gt;<br><br># 以纯文本输出格式列出所有副本控制器和服务。<br>kubectl <span class="hljs-keyword">get</span> rc,services<br><br># 以纯文本输出格式列出所有守护程序集，包括未初始化的守护程序集。<br>kubectl <span class="hljs-keyword">get</span> ds <span class="hljs-comment">--include-uninitialized</span><br><br># 列出在节点 server01 上运行的所有 Pod<br>kubectl <span class="hljs-keyword">get</span> pods <span class="hljs-comment">--field-selector=spec.nodeName=server01</span><br>kubectl describe - 显示一个或多个资源的详细状态，默认情况下包括未初始化的资源。<br><br># 显示名为 &lt;pod-<span class="hljs-type">name</span>&gt; 的 Pod 的详细信息。<br>kubectl describe nodes &lt;node-<span class="hljs-type">name</span>&gt;<br><br># 显示名为 &lt;pod-<span class="hljs-type">name</span>&gt; 的 Pod 的详细信息。<br>kubectl describe pods/&lt;pod-<span class="hljs-type">name</span>&gt;<br><br># 显示由名为 &lt;rc-<span class="hljs-type">name</span>&gt; 的副本控制器管理的所有 Pod 的详细信息。<br># 记住：副本控制器创建的任何 Pod 都以副本控制器的名称为前缀。<br>kubectl describe pods &lt;rc-<span class="hljs-type">name</span>&gt;<br><br># 描述所有的 Pod<br>kubectl describe pods<br>说明：<br>kubectl <span class="hljs-keyword">get</span> 命令通常用于检索同一资源类别的一个或多个资源。 它具有丰富的参数，允许你使用 -o 或 <span class="hljs-comment">--output 参数自定义输出格式。 你可以指定 -w 或 --watch 参数以开始监测特定对象的更新。 kubectl describe 命令更侧重于描述指定资源的许多相关方面。它可以调用对 API 服务器 的多个 API 调用来为用户构建视图。 例如，该 kubectl describe node 命令不仅检索有关节点的信息，还检索在其上运行的 Pod 的摘要，为节点生成的事件等。</span><br><br>kubectl <span class="hljs-keyword">delete</span> - 基于文件、标准输入或通过指定标签选择器、名称、资源选择器或资源来删除资源。<br><br># 使用 pod.yaml 文件中指定的类型和名称删除 Pod。<br>kubectl <span class="hljs-keyword">delete</span> -f pod.yaml<br><br># 删除所有带有 <span class="hljs-string">&#x27;&lt;label-key&gt;=&lt;label-value&gt;&#x27;</span> 标签的 Pod 和服务。<br>kubectl <span class="hljs-keyword">delete</span> pods,services -l &lt;label-key&gt;=&lt;label-<span class="hljs-keyword">value</span>&gt;<br><br># 删除所有 Pod，包括未初始化的 Pod。<br>kubectl <span class="hljs-keyword">delete</span> pods <span class="hljs-comment">--all</span><br>kubectl exec - 对 Pod 中的容器执行命令。<br><br># 从 Pod &lt;pod-<span class="hljs-type">name</span>&gt; 中获取运行 <span class="hljs-string">&#x27;date&#x27;</span> 的输出。默认情况下，输出来自第一个容器。<br>kubectl exec &lt;pod-<span class="hljs-type">name</span>&gt; <span class="hljs-comment">-- date</span><br><br># 运行输出 <span class="hljs-string">&#x27;date&#x27;</span> 获取在 Pod &lt;pod-<span class="hljs-type">name</span>&gt; 中容器 &lt;container-<span class="hljs-type">name</span>&gt; 的输出。<br>kubectl exec &lt;pod-<span class="hljs-type">name</span>&gt; -c &lt;container-<span class="hljs-type">name</span>&gt; <span class="hljs-comment">-- date</span><br><br># 获取一个交互 TTY 并在 Pod  &lt;pod-<span class="hljs-type">name</span>&gt; 中运行 /bin/bash。默认情况下，输出来自第一个容器。<br>kubectl exec -ti &lt;pod-<span class="hljs-type">name</span>&gt; <span class="hljs-comment">-- /bin/bash</span><br>kubectl logs - 打印 Pod 中容器的日志。<br><br># 返回 Pod &lt;pod-<span class="hljs-type">name</span>&gt; 的日志快照。<br>kubectl logs &lt;pod-<span class="hljs-type">name</span>&gt;<br><br># 从 Pod &lt;pod-<span class="hljs-type">name</span>&gt; 开始流式传输日志。这类似于 <span class="hljs-string">&#x27;tail -f&#x27;</span> Linux 命令。<br>kubectl logs -f &lt;pod-<span class="hljs-type">name</span>&gt;<br>kubectl diff - 查看集群建议更新的差异。<br><br># “pod.json”中包含的差异资源。<br>kubectl diff -f pod.json<br><br># 从标准输入读取的差异文件。<br>cat service.yaml | kubectl diff -f -<br></code></pre></td></tr></table></figure>
<h2 id="示例：创建和使用插件"><a href="#示例：创建和使用插件" class="headerlink" title="示例：创建和使用插件"></a>示例：创建和使用插件</h2><p>使用以下示例来帮助你熟悉编写和使用 kubectl 插件：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 用任何语言创建一个简单的插件，并为生成的可执行文件命名</span><br><span class="hljs-comment"># 以前缀 &quot;kubectl-&quot; 开始</span><br>cat ./kubectl-hello<br><span class="hljs-comment">#!/bin/sh</span><br><br><span class="hljs-comment"># 这个插件打印单词 &quot;hello world&quot;</span><br>echo <span class="hljs-string">&quot;hello world&quot;</span><br>这个插件写好了，把它变成可执行的：<br><br><br>sudo chmod a+x ./kubectl-hello<br><br><span class="hljs-comment"># 并将其移动到路径中的某个位置</span><br>sudo mv .<span class="hljs-regexp">/kubectl-hello /u</span>sr<span class="hljs-regexp">/local/</span>bin<br>sudo chown root:root <span class="hljs-regexp">/usr/</span>local/bin<br><br><span class="hljs-comment"># 你现在已经创建并&quot;安装了&quot;一个 kubectl 插件。</span><br><span class="hljs-comment"># 你可以开始使用这个插件，从 kubectl 调用它，就像它是一个常规命令一样</span><br>kubectl hello<br>hello world<br><span class="hljs-comment"># 你可以&quot;卸载&quot;一个插件，只需从你的 $PATH 中删除它</span><br>sudo rm <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>kubectl-hello<br>为了查看可用的所有 kubectl 插件，你可以使用 kubectl plugin list 子命令：<br><br>kubectl plugin list<br>输出类似于：<br><br>The following kubectl-compatible plugins are available:<br><br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>kubectl-hello<br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>kubectl-foo<br><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>kubectl-bar<br>kubectl plugin list 指令也可以向你告警哪些插件被运行，或是被其它插件覆盖了，例如：<br></code></pre></td></tr></table></figure>
<p>sudo chmod -x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl-foo # 删除执行权限<br>kubectl plugin list<br>The following kubectl-compatible plugins are available:</p>
<p>&#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl-hello<br>&#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl-foo</p>
<ul>
<li>warning: &#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl-foo identified as a plugin, but it is not executable<br>&#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl-bar</li>
</ul>
<p>error: one plugin warning was found</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">你可以将插件视为在现有 kubectl 命令之上构建更复杂功能的一种方法：</span><br><span class="language-xml"></span><br><span class="language-xml">cat ./kubectl-whoami</span><br><span class="language-xml">## 接下来的几个示例假设你已经将 kubectl-whoami 设置为以下内容：</span><br><span class="language-xml"></span><br><span class="language-xml">#!/bin/bash</span><br><span class="language-xml"></span><br><span class="language-xml">#这个插件利用 `kubectl config` 命令基于当前所选上下文输出当前用户的信息</span><br><span class="language-xml">kubectl config view --template=&#x27;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">range</span> .contexts &#125;&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name"><span class="hljs-built_in">if</span></span> eq .name <span class="hljs-string">&quot;&#x27;$(kubectl config current-context)&#x27;&quot;</span> &#125;&#125;</span><span class="language-xml">Current user: </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">printf</span> <span class="hljs-string">&quot;%s\n&quot;</span> .context.user &#125;&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">end</span> &#125;&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">end</span> &#125;&#125;</span><span class="language-xml">&#x27;</span><br><span class="language-xml">运行以上命令将为你提供一个输出，其中包含 KUBECONFIG 文件中当前上下文的用户：</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># 使文件成为可执行的</span><br>sudo <span class="hljs-built_in">chmod</span> +x ./kubectl-whoami<br><br><span class="hljs-comment"># 然后移动到你的路径中</span><br><br>sudo <span class="hljs-built_in">mv</span> ./kubectl-whoami /usr/local/bin<br><br>kubectl <span class="hljs-built_in">whoami</span><br>Current user: plugins-user<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/k8s/" class="category-chain-item">k8s</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/k8s/">#k8s</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>命令行工具 (kubectl)</div>
      <div>https://liyupin.github.io/2022/07/14/kubectl/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Cper Liu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年7月14日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/07/14/DevMilOps%E9%83%A8%E7%BD%B2%E6%96%87%E6%A1%A3-Venus/" title="DevMilOps部署文档-Venus">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">DevMilOps部署文档-Venus</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/07/14/docker%20%E7%BD%91%E7%BB%9C/" title="docker 网络">
                        <span class="hidden-mobile">docker 网络</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
